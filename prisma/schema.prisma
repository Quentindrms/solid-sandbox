generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model game {
  id         Int          @id @default(autoincrement())
  name       String
  genre      String
  match      match[]
  tournament tournament[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model match {
  id                        Int        @id @default(autoincrement())
  tournament_id             Int
  game_id                   Int
  match_date                DateTime   @db.Timestamp(6)
  team1_id                  Int
  team2_id                  Int
  team1_score               Int        @default(0)
  team2_score               Int        @default(0)
  best_of                   Int        @default(3)
  game                      game       @relation(fields: [game_id], references: [id])
  team_match_team1_idToteam team       @relation("match_team1_idToteam", fields: [team1_id], references: [id])
  team_match_team2_idToteam team       @relation("match_team2_idToteam", fields: [team2_id], references: [id])
  tournament                tournament @relation(fields: [tournament_id], references: [id], onDelete: Cascade)
}

model player {
  id        Int       @id @default(autoincrement())
  nickname  String    @unique
  full_name String?
  birthdate DateTime? @db.Date
  country   String?
  team_id   Int?
  team      team?     @relation(fields: [team_id], references: [id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model team {
  id                         Int               @id @default(autoincrement())
  name                       String            @unique
  org_city                   String?
  founded_year               Int?
  match_match_team1_idToteam match[]           @relation("match_team1_idToteam")
  match_match_team2_idToteam match[]           @relation("match_team2_idToteam")
  player                     player[]
  team_tournament            team_tournament[]
}

model team_tournament {
  id            Int        @id @default(autoincrement())
  team_id       Int
  tournament_id Int
  seed          Int?
  team          team       @relation(fields: [team_id], references: [id], onDelete: Cascade)
  tournament    tournament @relation(fields: [tournament_id], references: [id], onDelete: Cascade)

  @@unique([team_id, tournament_id])
}

model token {
  id         Int      @id @default(autoincrement())
  user_id    Int
  token      String
  created_at DateTime @default(now()) @db.Timestamp(6)
  user       user     @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model tournament {
  id              Int               @id @default(autoincrement())
  name            String
  game_id         Int
  start_date      DateTime          @db.Date
  end_date        DateTime          @db.Date
  location        String?
  match           match[]
  team_tournament team_tournament[]
  game            game              @relation(fields: [game_id], references: [id])
}

model user {
  id         Int      @id @default(autoincrement())
  email      String   @unique
  password   String
  created_at DateTime @db.Timestamp(6)
  token      token[]
}
